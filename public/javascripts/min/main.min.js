function userLikesToArray(){var e=$.cookie("likes");return e.split(",")}function addLike(e){var t=userLikesToArray();return hasLike(e)?!1:(t.push(e),void $.cookie("likes",t))}function removeLike(e){var t=userLikesToArray(),i=t.indexOf(e);return hasLike(e)?(t.splice(i,1),void $.cookie("likes",t)):!1}function hasLike(e){var t=userLikesToArray(),i=t.indexOf(e);return-1!==i}var cssBezier=new Ease(BezierEasing(.7,0,.3,1)),gridBagBezier=new Ease(BezierEasing(.42,0,.58,1));!function(e,t,i,n,a,r,s){e.GoogleAnalyticsObject=a,e[a]=e[a]||function(){(e[a].q=e[a].q||[]).push(arguments)},e[a].l=1*new Date,r=t.createElement(i),s=t.getElementsByTagName(i)[0],r.async=1,r.src=n,s.parentNode.insertBefore(r,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-58975311-1","auto");var likes={userLikes:null,saveUserLikes:function(){},likeBag:function(){},unlikeBag:function(){},hasLike:function(){}},site={colors:["black","white","orange","yellow","cyan","red","green"],chars:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split(""),randomString:function(e){for(var t="",i=0;e>i;i++)t+=site.chars[Math.floor(Math.random()*site.chars.length)];return t},breakpts:{sml:650,med:960,lrg:1440},transistionEnd:"webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",breakpt:function(){var e=window.innerWidth,t="lrg";for(var i in site.breakpts)if(site.breakpts[i]>=e){t=i;break}return t},refreshTypeOnTotes:function(){_.each($(".actual-tote"),function(e){var t=$(e).find(".bag-body").width(),i=t/2;if($(e).find(".bag-body").css("font-size",i+"px"),$(e).find(".editable-field").length>0)for(var n=$(e).find(".textfields-wrap .editable-field"),a=0;a<n.length;a++)bagObject.updateTextAreaSize($(n[a]).find("textarea"));if($(e).find(".text").length>0)for(var r=$(e).find(".textfields-wrap .text"),s=0;s<r.length;s++){var o=Number($(r[s]).attr("data-x"))*i,d=Number($(r[s]).attr("data-y"))*i;TweenLite.to(r[s],0,{x:o,y:d})}})},getTransformValue:function(e,t){var i=e.css("transform").replace(/[^0-9\-.,]/g,"").split(","),n=i[12]||i[4],a=i[13]||i[5];return void 0===n&&(n=0),void 0===a&&(a=0),"x"===t?n:"y"===t?a:void 0},render:function(e,t,i,n){$.get("/templates/_"+t+".html",function(t){var a=Handlebars.compile(t),r=a(e);$(i).html(r),"undefined"!=typeof n&&n()})}},bagObject={data:{textfields:[],size:"small",color:"black",likes:0,editMode:!1},htmlElement:null,parent:null,refreshType:function(){var e=this.htmlElement,t=e.find(".bag-body").width(),i=t/2;e.find(".bag-body").css("font-size",i+"px")},toggleSize:function(e){var t=this;"big"===e||"small"===t.data.size&&"undefined"==typeof e?(t.data.size="big",t.htmlElement.removeClass("small").addClass("big")):("small"===e||"big"===t.data.size&&"undefined"==typeof e)&&(t.data.size="small",t.htmlElement.removeClass("big").addClass("small")),setTimeout(function(){t.refreshType()},300)},changeColor:function(e){var t=this;_.contains(site.colors,e)&&($(t.htmlElement).attr("class","tote-wrap "+e+" "+t.data.size),t.data.color=e)},updateTextAreaSize:function(e){var t=this,i=e.parents(".editable-field"),n=i.attr("data-id"),a=e.siblings(".clone-text"),r=e.val();if(""===r&&(r="Type Something."),a.html(r.replace(/\n/g,"<br />")),t.data&&t.data.textfields){var s=_.findWhere(t.data.textfields,{_id:n});s.text=r,""===e.val()?i.addClass("new"):i.removeClass("new");var o=parseInt(i.parents(".bag-body").css("font-size")),d=s.x*o,l=s.y*o;TweenLite.to(i,0,{x:d,y:l})}TweenLite.to(i,.1,{height:a.height()})},draw:function(e,t){var i=this;if("undefined"==typeof e&&null!==i.parent)e=$(i.parent);else{if(null===i.parent&&"undefined"==typeof e)return void console.log("you done fucked up");null===i.parent&&"undefined"!=typeof e&&(i.parent=e)}var n={bags:[i.data]};site.render(n,"bag",i.parent,function(){i.htmlElement=i.parent.find(".tote-wrap"),site.refreshTypeOnTotes(),"undefined"!=typeof t&&t()})},newTextField:function(){for(var e={y:0,x:0,width:"100%",justify:"left",fontSize:.28,kerning:-.03,leading:1},t=site.randomString(16);"undefined"!=typeof _.findWhere(this.data.textfields,{_id:t});)t=site.randomString(16);e._id=t,this.data.textfields.push(e),this.data.textfields.length>=4&&$(".addTextfield").addClass("disabled")},deleteTextField:function(e,t){var i=this,n=$(this.htmlElement).find(".editable-field[data-id="+e+"]");TweenLite.to(n,.3,{scale:1.15,alpha:0,onComplete:function(){n.remove(),i.data.textfields=_.reject(i.data.textfields,function(t){return t._id===e}),i.data.textfields.length<4&&$(".addTextfield").removeClass("disabled"),"undefined"!=typeof t&&t()}})},saveAs:function(){var e=_.extend({},this.data);e.textfields=JSON.stringify(e.textfields),e.editMode=null,e.timestamp=Math.round((new Date).getTime()/1e3),$.ajax({type:"POST",data:e,url:"/totes/createtote",dataType:"JSON"}).done(function(e){""===e.msg?window.location.href="/":alert("Error: "+e.msg)})}};$(document).ready(function(){void 0===$.cookie("likes")&&$.cookie("likes",""),$(document).hammer().on("tap",".logo",function(){window.location.href="/"}),site.refreshTypeOnTotes(),$(window).resize(function(){site.refreshTypeOnTotes()}),ga("send","pageview")});